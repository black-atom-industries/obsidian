<%
/* Helper: convert hex to "R, G, B" string for Obsidian's rgba() patterns */
function hexToRgb(hex) {
  const r = parseInt(hex.slice(1, 3), 16);
  const g = parseInt(hex.slice(3, 5), 16);
  const b = parseInt(hex.slice(5, 7), 16);
  return `${r}, ${g}, ${b}`;
}

const isDark = theme.meta.appearance === "dark";
const selector = isDark ? ".theme-dark" : ".theme-light";
const isDefault = theme.meta.key === "black-atom-default-dark" || theme.meta.key === "black-atom-default-light";
%>
<% if (isDefault) { %>
/* Fallback: <%= theme.meta.label %> (no Style Settings plugin) */
<%= selector %> {
<% if (isDark) { %>
  --color-base-00: <%= theme.primaries.d10 %>;
  --color-base-05: <%= theme.primaries.d20 %>;
  --color-base-10: <%= theme.primaries.d30 %>;
  --color-base-20: <%= theme.primaries.d40 %>;
  --color-base-25: <%= theme.primaries.m10 %>;
  --color-base-30: <%= theme.primaries.m20 %>;
  --color-base-35: <%= theme.primaries.m30 %>;
  --color-base-40: <%= theme.primaries.m40 %>;
  --color-base-50: <%= theme.primaries.l10 %>;
  --color-base-60: <%= theme.primaries.l20 %>;
  --color-base-70: <%= theme.primaries.l30 %>;
  --color-base-100: <%= theme.primaries.l40 %>;
<% } else { %>
  --color-base-00: <%= theme.primaries.l40 %>;
  --color-base-05: <%= theme.primaries.l30 %>;
  --color-base-10: <%= theme.primaries.l20 %>;
  --color-base-20: <%= theme.primaries.l10 %>;
  --color-base-25: <%= theme.primaries.m40 %>;
  --color-base-30: <%= theme.primaries.m30 %>;
  --color-base-35: <%= theme.primaries.m20 %>;
  --color-base-40: <%= theme.primaries.m10 %>;
  --color-base-50: <%= theme.primaries.d40 %>;
  --color-base-60: <%= theme.primaries.d30 %>;
  --color-base-70: <%= theme.primaries.d20 %>;
  --color-base-100: <%= theme.primaries.d10 %>;
<% } %>

  /* Extended Colors */
  --color-red: <%= theme.palette.red %>;
  --color-red-rgb: <%= hexToRgb(theme.palette.red) %>;
  --color-orange: <%= theme.palette.darkYellow %>;
  --color-orange-rgb: <%= hexToRgb(theme.palette.darkYellow) %>;
  --color-yellow: <%= theme.palette.yellow %>;
  --color-yellow-rgb: <%= hexToRgb(theme.palette.yellow) %>;
  --color-green: <%= theme.palette.green %>;
  --color-green-rgb: <%= hexToRgb(theme.palette.green) %>;
  --color-cyan: <%= theme.palette.cyan %>;
  --color-cyan-rgb: <%= hexToRgb(theme.palette.cyan) %>;
  --color-blue: <%= theme.palette.blue %>;
  --color-blue-rgb: <%= hexToRgb(theme.palette.blue) %>;
  --color-purple: <%= theme.palette.magenta %>;
  --color-purple-rgb: <%= hexToRgb(theme.palette.magenta) %>;
  --color-pink: <%= theme.palette.darkMagenta %>;
  --color-pink-rgb: <%= hexToRgb(theme.palette.darkMagenta) %>;

  /* Backgrounds */
  --background-primary: <%= theme.ui.bg.default %>;
  --background-primary-alt: <%= theme.ui.bg.active %>;
  --background-secondary: <%= theme.ui.bg.panel %>;
  --background-secondary-alt: <%= theme.ui.bg.float %>;
  --background-modifier-hover: <%= theme.ui.bg.hover %>;
  --background-modifier-active-hover: <%= theme.ui.bg.hover %>;
  --background-modifier-border: <%= theme.ui.bg.active %>;
  --background-modifier-border-hover: <%= theme.ui.bg.hover %>;
  --background-modifier-border-focus: <%= theme.ui.fg.accent %>;
  --background-modifier-error-rgb: <%= hexToRgb(theme.ui.bg.negative) %>;
  --background-modifier-error: <%= theme.ui.bg.negative %>;
  --background-modifier-error-hover: <%= theme.ui.bg.negative %>;
  --background-modifier-success-rgb: <%= hexToRgb(theme.ui.bg.positive) %>;
  --background-modifier-success: <%= theme.ui.bg.positive %>;
  --background-modifier-message: <%= theme.ui.bg.info %>;
  --background-modifier-form-field: <%= theme.ui.bg.default %>;

  /* Text */
  --text-normal: <%= theme.ui.fg.default %>;
  --text-muted: <%= theme.ui.fg.subtle %>;
  --text-faint: <%= theme.ui.fg.disabled %>;
  --text-accent: <%= theme.ui.fg.accent %>;
  --text-accent-hover: <%= theme.ui.fg.accent %>;
  --text-on-accent: <%= theme.ui.fg.contrast %>;
  --text-on-accent-inverted: <%= theme.ui.fg.default %>;
  --text-error: <%= theme.ui.fg.negative %>;
  --text-warning: <%= theme.ui.fg.warn %>;
  --text-success: <%= theme.ui.fg.positive %>;
  --text-selection: <%= theme.ui.bg.selection %>;
  --text-highlight-bg: <%= theme.ui.bg.search %>;

  /* Interactive */
  --interactive-normal: <%= theme.ui.bg.default %>;
  --interactive-hover: <%= theme.ui.bg.hover %>;
  --interactive-accent: <%= theme.ui.fg.accent %>;
  --interactive-accent-hover: <%= theme.ui.fg.accent %>;

  /* Headings */
  --h1-color: <%= theme.syntax.markup.heading.h1 %>;
  --h2-color: <%= theme.syntax.markup.heading.h2 %>;
  --h3-color: <%= theme.syntax.markup.heading.h3 %>;
  --h4-color: <%= theme.syntax.markup.heading.h4 %>;
  --h5-color: <%= theme.syntax.markup.heading.h5 %>;
  --h6-color: <%= theme.syntax.markup.heading.h6 %>;

  /* Markup */
  --bold-color: <%= theme.syntax.markup.strong %>;
  --italic-color: <%= theme.syntax.markup.italic %>;
  --blockquote-border-color: <%= theme.syntax.markup.quote %>;
  --link-color: <%= theme.syntax.markup.link %>;
  --link-color-hover: <%= theme.syntax.markup.link %>;
  --link-external-color: <%= theme.syntax.markup.link %>;
  --link-external-color-hover: <%= theme.syntax.markup.link %>;

  /* Code / Syntax Highlighting */
  --code-normal: <%= theme.syntax.variable.default %>;
  --code-comment: <%= theme.syntax.comment.default %>;
  --code-function: <%= theme.syntax.func.default %>;
  --code-important: <%= theme.syntax.keyword.default %>;
  --code-keyword: <%= theme.syntax.keyword.default %>;
  --code-operator: <%= theme.syntax.operator.default %>;
  --code-property: <%= theme.syntax.property.default %>;
  --code-punctuation: <%= theme.syntax.punctuation.default %>;
  --code-string: <%= theme.syntax.string.default %>;
  --code-tag: <%= theme.syntax.tag.default %>;
  --code-value: <%= theme.syntax.constant.default %>;
  --code-background: <%= theme.syntax.markup.code.bg %>;

  /* Tags */
  --tag-color: <%= theme.ui.fg.accent %>;
  --tag-color-hover: <%= theme.ui.fg.accent %>;
  --tag-background: <%= theme.ui.bg.hover %>;
  --tag-background-hover: <%= theme.ui.bg.active %>;

  /* Graph */
  --graph-line: <%= theme.ui.bg.active %>;
  --graph-node: <%= theme.ui.fg.accent %>;
  --graph-node-focused: <%= theme.ui.fg.accent %>;
  --graph-node-tag: <%= theme.palette.cyan %>;
  --graph-node-attachment: <%= theme.palette.green %>;

  /* Scrollbar */
  --scrollbar-bg: <%= theme.ui.bg.default %>;
  --scrollbar-thumb-bg: <%= theme.ui.bg.active %>;
  --scrollbar-active-thumb-bg: <%= theme.ui.fg.subtle %>;

  /* Nav */
  --nav-item-background-hover: <%= theme.ui.bg.hover %>;
  --nav-item-background-active: <%= theme.ui.bg.active %>;
  --nav-item-background-selected: <%= theme.ui.bg.selection %>;
  --nav-item-color: <%= theme.ui.fg.default %>;
  --nav-item-color-hover: <%= theme.ui.fg.default %>;
  --nav-item-color-active: <%= theme.ui.fg.accent %>;
  --nav-item-color-selected: <%= theme.ui.fg.default %>;
}

<% } %>
/* <%= theme.meta.label %> */
<%= selector %>.<%= theme.meta.key %> {
  /* Foundation: Base Colors */
<% if (isDark) { %>
  --color-base-00: <%= theme.primaries.d10 %>;
  --color-base-05: <%= theme.primaries.d20 %>;
  --color-base-10: <%= theme.primaries.d30 %>;
  --color-base-20: <%= theme.primaries.d40 %>;
  --color-base-25: <%= theme.primaries.m10 %>;
  --color-base-30: <%= theme.primaries.m20 %>;
  --color-base-35: <%= theme.primaries.m30 %>;
  --color-base-40: <%= theme.primaries.m40 %>;
  --color-base-50: <%= theme.primaries.l10 %>;
  --color-base-60: <%= theme.primaries.l20 %>;
  --color-base-70: <%= theme.primaries.l30 %>;
  --color-base-100: <%= theme.primaries.l40 %>;
<% } else { %>
  --color-base-00: <%= theme.primaries.l40 %>;
  --color-base-05: <%= theme.primaries.l30 %>;
  --color-base-10: <%= theme.primaries.l20 %>;
  --color-base-20: <%= theme.primaries.l10 %>;
  --color-base-25: <%= theme.primaries.m40 %>;
  --color-base-30: <%= theme.primaries.m30 %>;
  --color-base-35: <%= theme.primaries.m20 %>;
  --color-base-40: <%= theme.primaries.m10 %>;
  --color-base-50: <%= theme.primaries.d40 %>;
  --color-base-60: <%= theme.primaries.d30 %>;
  --color-base-70: <%= theme.primaries.d20 %>;
  --color-base-100: <%= theme.primaries.d10 %>;
<% } %>

  /* Extended Colors */
  --color-red: <%= theme.palette.red %>;
  --color-red-rgb: <%= hexToRgb(theme.palette.red) %>;
  --color-orange: <%= theme.palette.darkYellow %>;
  --color-orange-rgb: <%= hexToRgb(theme.palette.darkYellow) %>;
  --color-yellow: <%= theme.palette.yellow %>;
  --color-yellow-rgb: <%= hexToRgb(theme.palette.yellow) %>;
  --color-green: <%= theme.palette.green %>;
  --color-green-rgb: <%= hexToRgb(theme.palette.green) %>;
  --color-cyan: <%= theme.palette.cyan %>;
  --color-cyan-rgb: <%= hexToRgb(theme.palette.cyan) %>;
  --color-blue: <%= theme.palette.blue %>;
  --color-blue-rgb: <%= hexToRgb(theme.palette.blue) %>;
  --color-purple: <%= theme.palette.magenta %>;
  --color-purple-rgb: <%= hexToRgb(theme.palette.magenta) %>;
  --color-pink: <%= theme.palette.darkMagenta %>;
  --color-pink-rgb: <%= hexToRgb(theme.palette.darkMagenta) %>;

  /* Backgrounds */
  --background-primary: <%= theme.ui.bg.default %>;
  --background-primary-alt: <%= theme.ui.bg.active %>;
  --background-secondary: <%= theme.ui.bg.panel %>;
  --background-secondary-alt: <%= theme.ui.bg.float %>;
  --background-modifier-hover: <%= theme.ui.bg.hover %>;
  --background-modifier-active-hover: <%= theme.ui.bg.hover %>;
  --background-modifier-border: <%= theme.ui.bg.active %>;
  --background-modifier-border-hover: <%= theme.ui.bg.hover %>;
  --background-modifier-border-focus: <%= theme.ui.fg.accent %>;
  --background-modifier-error-rgb: <%= hexToRgb(theme.ui.bg.negative) %>;
  --background-modifier-error: <%= theme.ui.bg.negative %>;
  --background-modifier-error-hover: <%= theme.ui.bg.negative %>;
  --background-modifier-success-rgb: <%= hexToRgb(theme.ui.bg.positive) %>;
  --background-modifier-success: <%= theme.ui.bg.positive %>;
  --background-modifier-message: <%= theme.ui.bg.info %>;
  --background-modifier-form-field: <%= theme.ui.bg.default %>;

  /* Text */
  --text-normal: <%= theme.ui.fg.default %>;
  --text-muted: <%= theme.ui.fg.subtle %>;
  --text-faint: <%= theme.ui.fg.disabled %>;
  --text-accent: <%= theme.ui.fg.accent %>;
  --text-accent-hover: <%= theme.ui.fg.accent %>;
  --text-on-accent: <%= theme.ui.fg.contrast %>;
  --text-on-accent-inverted: <%= theme.ui.fg.default %>;
  --text-error: <%= theme.ui.fg.negative %>;
  --text-warning: <%= theme.ui.fg.warn %>;
  --text-success: <%= theme.ui.fg.positive %>;
  --text-selection: <%= theme.ui.bg.selection %>;
  --text-highlight-bg: <%= theme.ui.bg.search %>;

  /* Interactive */
  --interactive-normal: <%= theme.ui.bg.default %>;
  --interactive-hover: <%= theme.ui.bg.hover %>;
  --interactive-accent: <%= theme.ui.fg.accent %>;
  --interactive-accent-hover: <%= theme.ui.fg.accent %>;

  /* Headings */
  --h1-color: <%= theme.syntax.markup.heading.h1 %>;
  --h2-color: <%= theme.syntax.markup.heading.h2 %>;
  --h3-color: <%= theme.syntax.markup.heading.h3 %>;
  --h4-color: <%= theme.syntax.markup.heading.h4 %>;
  --h5-color: <%= theme.syntax.markup.heading.h5 %>;
  --h6-color: <%= theme.syntax.markup.heading.h6 %>;

  /* Markup */
  --bold-color: <%= theme.syntax.markup.strong %>;
  --italic-color: <%= theme.syntax.markup.italic %>;
  --blockquote-border-color: <%= theme.syntax.markup.quote %>;
  --link-color: <%= theme.syntax.markup.link %>;
  --link-color-hover: <%= theme.syntax.markup.link %>;
  --link-external-color: <%= theme.syntax.markup.link %>;
  --link-external-color-hover: <%= theme.syntax.markup.link %>;

  /* Code / Syntax Highlighting */
  --code-normal: <%= theme.syntax.variable.default %>;
  --code-comment: <%= theme.syntax.comment.default %>;
  --code-function: <%= theme.syntax.func.default %>;
  --code-important: <%= theme.syntax.keyword.default %>;
  --code-keyword: <%= theme.syntax.keyword.default %>;
  --code-operator: <%= theme.syntax.operator.default %>;
  --code-property: <%= theme.syntax.property.default %>;
  --code-punctuation: <%= theme.syntax.punctuation.default %>;
  --code-string: <%= theme.syntax.string.default %>;
  --code-tag: <%= theme.syntax.tag.default %>;
  --code-value: <%= theme.syntax.constant.default %>;
  --code-background: <%= theme.syntax.markup.code.bg %>;

  /* Tags */
  --tag-color: <%= theme.ui.fg.accent %>;
  --tag-color-hover: <%= theme.ui.fg.accent %>;
  --tag-background: <%= theme.ui.bg.hover %>;
  --tag-background-hover: <%= theme.ui.bg.active %>;

  /* Graph */
  --graph-line: <%= theme.ui.bg.active %>;
  --graph-node: <%= theme.ui.fg.accent %>;
  --graph-node-focused: <%= theme.ui.fg.accent %>;
  --graph-node-tag: <%= theme.palette.cyan %>;
  --graph-node-attachment: <%= theme.palette.green %>;

  /* Scrollbar */
  --scrollbar-bg: <%= theme.ui.bg.default %>;
  --scrollbar-thumb-bg: <%= theme.ui.bg.active %>;
  --scrollbar-active-thumb-bg: <%= theme.ui.fg.subtle %>;

  /* Nav */
  --nav-item-background-hover: <%= theme.ui.bg.hover %>;
  --nav-item-background-active: <%= theme.ui.bg.active %>;
  --nav-item-background-selected: <%= theme.ui.bg.selection %>;
  --nav-item-color: <%= theme.ui.fg.default %>;
  --nav-item-color-hover: <%= theme.ui.fg.default %>;
  --nav-item-color-active: <%= theme.ui.fg.accent %>;
  --nav-item-color-selected: <%= theme.ui.fg.default %>;
}
